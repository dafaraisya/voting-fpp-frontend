{"remainingRequest":"/home/dafa/voting-fpp-frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/dafa/voting-fpp-frontend/src/views/vote/Scan.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/dafa/voting-fpp-frontend/src/views/vote/Scan.vue","mtime":1609147625285},{"path":"/home/dafa/voting-fpp-frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/dafa/voting-fpp-frontend/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/dafa/voting-fpp-frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/dafa/voting-fpp-frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBheGlvcyBmcm9tICdheGlvcycKaW1wb3J0IHsgUXJjb2RlU3RyZWFtIH0gZnJvbSAndnVlLXFyY29kZS1yZWFkZXInCmltcG9ydCBTd2FsIGZyb20gJ3N3ZWV0YWxlcnQyJwoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdTY2FuJywKICBjb21wb25lbnRzOiB7CiAgICBRcmNvZGVTdHJlYW0KICB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBkYXRhUGFydGljaXBhbnQgOiB7CiAgICAgICAgbmFtZTogJycsCiAgICAgICAgbmltOiAnJywKICAgICAgICBlbWFpbDogJycKICAgICAgfSwKICAgICAgaWQgOiAnJywKICAgICAgbG9hZGluZyA6IGZhbHNlCiAgICB9CiAgfSwKICBtZXRob2RzOnsKICAgIGFzeW5jIG9uSW5pdCAocHJvbWlzZSkgewogICAgICB0aGlzLmxvYWRpbmcgPSB0cnVlCgogICAgICB0cnkgewogICAgICAgIGF3YWl0IHByb21pc2UKICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yKQogICAgICB9IGZpbmFsbHkgewogICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlCiAgICAgIH0KICAgIH0sCiAgICBvbkRlY29kZSAoZGVjb2RlZFN0cmluZykgewogICAgICB0aGlzLmlkID0gZGVjb2RlZFN0cmluZzsKICAgICAgYXhpb3MKICAgICAgICAuZ2V0KCJodHRwOi8vcGVtaXJhLmZwcHVuZGlwLmNvbTozMDAwL2FwaS92MS9wYXJ0aWNpcGFudC8iK3RoaXMuaWQpCiAgICAgICAgLnRoZW4ocmVzID0+IHsKICAgICAgICAgIHRoaXMuZGF0YVBhcnRpY2lwYW50ID0gcmVzLmRhdGEuZGF0YTsKICAgICAgICAgIHRoaXMuY2hlY2soKTsKICAgICAgICB9KQogICAgICAgIC5jYXRjaChlcnIgPT4ge2NvbnNvbGUubG9nKGVycil9KTsKICAgIH0sCiAgICBjaGVjaygpIHsKICAgICAgLy8gY2VrIGRhdGEgcGFydGlzaXBhbiBhZGEgZW5nZ2FrCiAgICAgIGlmKHRoaXMuZGF0YVBhcnRpY2lwYW50ID09IG51bGwpIHsKICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7IG5hbWU6ICJFcnJvciIsIHBhcmFtczoge2Vycm9yIDogJ2ZhaWxlZC1ub3QtZm91bmQnfX0pOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIGNlayBhcGFrYWggc3VkYWggdm90ZSBhcGEgYmVsdW0KICAgICAgICB2YXIgZGF0YVBhcnRpY2lwYW50U3RyaW5nID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0aGlzLmRhdGFQYXJ0aWNpcGFudCkpOwogICAgICAgIGlmKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChkYXRhUGFydGljaXBhbnRTdHJpbmcsICd2b3RpbmcnKSkgewogICAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goeyBuYW1lOiAiRXJyb3IiLCBwYXJhbXM6IHtlcnJvciA6ICdmYWlsZWQtYWxyZWFkeS12b3RlJ319KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgLy8gY2VrIGFwYWthaCBzZWRhbmcgc2VzaW55YSBhdGF1IGVuZ2dhawogICAgICAgICAgdmFyIHRvZGF5ID0gbmV3IERhdGUoKTsKICAgICAgICAgIGNvbnN0IGRhdGUgPSB0b2RheS5nZXRGdWxsWWVhcigpKyctJysodG9kYXkuZ2V0TW9udGgoKSsxKSsnLScrKCcwJyArIHRvZGF5LmdldERhdGUoKSkuc2xpY2UoLTIpOwogICAgICAgICAgY29uc3QgdGltZSA9ICgnMCcgKyB0b2RheS5nZXRIb3VycygpKS5zbGljZSgtMikgKyAiOiIgKyB0b2RheS5nZXRNaW51dGVzKCkgKyAiOiIgKyB0b2RheS5nZXRTZWNvbmRzKCk7CiAgICAgICAgICBjb25zdCBkYXRlVGltZSA9IGRhdGUgKydUJysgdGltZSArICcuMDAwWic7CiAgICAgICAgICBpZih0aGlzLmRhdGFQYXJ0aWNpcGFudC5zZXNzaW9uLm1pbiA8IGRhdGVUaW1lICYmIHRoaXMuZGF0YVBhcnRpY2lwYW50LnNlc3Npb24ubWF4ID4gZGF0ZVRpbWUpIHsKICAgICAgICAgICAgU3dhbC5maXJlKHsKICAgICAgICAgICAgICAgIGljb246ICdzdWNjZXNzJywKICAgICAgICAgICAgICAgIHRpdGxlOiAnQXV0ZW50aWthc2kgYmVyaGFzaWwnLAogICAgICAgICAgICAgICAgdGV4dDogJ1NlbGFtYXQgZGF0YW5nICcgKyB0aGlzLmRhdGFQYXJ0aWNpcGFudC5uYW1lLAogICAgICAgICAgICAgICAgc2hvd0NvbmZpcm1CdXR0b246IHRydWUKICAgICAgICAgICAgfSkudGhlbigoKT0+ewogICAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgic2V0QXV0aGVudGljYXRpb24iLCB0cnVlKTsKICAgICAgICAgICAgICB0aGlzLiRyb3V0ZXIucmVwbGFjZSh7IG5hbWU6ICJWb3RpbmciLCBwYXJhbXMgOiB7aWQ6dGhpcy5kYXRhUGFydGljaXBhbnQuX2lkfSwgcXVlcnk6IHsnc3VjY2Vzcyc6IHRydWV9IH0pOwogICAgICAgICAgICB9KQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goeyBuYW1lOiAiRXJyb3IiLCBwYXJhbXM6IHtlcnJvciA6ICdmYWlsZWQtbm90LXlvdXItc2Vzc2lvbid9fSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfSwKICBtb3VudGVkKCkgewogICAgYXhpb3MKICAgICAgLmdldCgiaHR0cDovL3BlbWlyYS5mcHB1bmRpcC5jb206MzAwMC9hcGkvdjEvcGFydGljaXBhbnQvYWxsIikKICAgICAgLnRoZW4ocmVzID0+ICh0aGlzLmRhdGFQYXJ0aWNpcGFudHMgPSByZXMuZGF0YS5kYXRhKSkKICAgICAgLmNhdGNoKGVycm9yID0+IGNvbnNvbGUubG9nKGVycm9yKSkKICB9Cn0K"},{"version":3,"sources":["Scan.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAuBA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Scan.vue","sourceRoot":"src/views/vote","sourcesContent":["<template>\n  <div class=\"scan page pt-5\">\n      <img src=\"\" alt=\"\">\n      <h1 class=\"text-white tittle\">Scan kartu</h1>\n\n      <div class=\"scanner-card mt-5\">\n        <b-row>\n          <b-col lg=\"3\"/>\n          <b-col lg=\"6\">\n            <b-container class=\"bg-white p-3 rounded-sm shadow-sm\">\n              <qrcode-stream @init=\"onInit\" @decode=\"onDecode\">\n                <div class=\"loading-indicator\" v-if=\"loading\">\n                  Loading...\n                </div>\n              </qrcode-stream>\n            </b-container>\n          </b-col>\n        </b-row>\n      </div>\n  </div>\n</template>\n\n<script>\nimport axios from 'axios'\nimport { QrcodeStream } from 'vue-qrcode-reader'\nimport Swal from 'sweetalert2'\n\nexport default {\n  name: 'Scan',\n  components: {\n    QrcodeStream\n  },\n  data() {\n    return {\n      dataParticipant : {\n        name: '',\n        nim: '',\n        email: ''\n      },\n      id : '',\n      loading : false\n    }\n  },\n  methods:{\n    async onInit (promise) {\n      this.loading = true\n\n      try {\n        await promise\n      } catch (error) {\n        console.error(error)\n      } finally {\n        this.loading = false\n      }\n    },\n    onDecode (decodedString) {\n      this.id = decodedString;\n      axios\n        .get(\"http://pemira.fppundip.com:3000/api/v1/participant/\"+this.id)\n        .then(res => {\n          this.dataParticipant = res.data.data;\n          this.check();\n        })\n        .catch(err => {console.log(err)});\n    },\n    check() {\n      // cek data partisipan ada enggak\n      if(this.dataParticipant == null) {\n        this.$router.push({ name: \"Error\", params: {error : 'failed-not-found'}});\n      } else {\n        // cek apakah sudah vote apa belum\n        var dataParticipantString = JSON.parse(JSON.stringify(this.dataParticipant));\n        if(Object.prototype.hasOwnProperty.call(dataParticipantString, 'voting')) {\n          this.$router.push({ name: \"Error\", params: {error : 'failed-already-vote'}});\n        } else {\n          // cek apakah sedang sesinya atau enggak\n          var today = new Date();\n          const date = today.getFullYear()+'-'+(today.getMonth()+1)+'-'+('0' + today.getDate()).slice(-2);\n          const time = ('0' + today.getHours()).slice(-2) + \":\" + today.getMinutes() + \":\" + today.getSeconds();\n          const dateTime = date +'T'+ time + '.000Z';\n          if(this.dataParticipant.session.min < dateTime && this.dataParticipant.session.max > dateTime) {\n            Swal.fire({\n                icon: 'success',\n                title: 'Autentikasi berhasil',\n                text: 'Selamat datang ' + this.dataParticipant.name,\n                showConfirmButton: true\n            }).then(()=>{\n              this.$store.commit(\"setAuthentication\", true);\n              this.$router.replace({ name: \"Voting\", params : {id:this.dataParticipant._id}, query: {'success': true} });\n            })\n          } else {\n            this.$router.push({ name: \"Error\", params: {error : 'failed-not-your-session'}});\n          }\n        }\n      }\n    }\n  },\n  mounted() {\n    axios\n      .get(\"http://pemira.fppundip.com:3000/api/v1/participant/all\")\n      .then(res => (this.dataParticipants = res.data.data))\n      .catch(error => console.log(error))\n  }\n}\n</script>\n<style scoped>\n.tittle, h1 {\n    font-weight: bold;\n}\n\n.page {\n  margin-top:100px;\n}\n\n.scanner-card {\n    display: block;\n    margin-left: auto;\n    margin-right: auto;\n    max-width: 1000px;\n}\n.alert {\n    display: block;\n    margin-left: auto;\n    margin-right: auto;\n    max-width: 500px;\n}\n.loading-indicator {\n  font-size: 20px ;\n  font-weight: bold;\n  display: block;\n  margin-left: auto;\n  margin-right: auto;\n  margin-top: 100px ;\n  width: 100px;\n}\n\n@media only screen and (min-width: 1200px) and (max-width: 1920px){\n    .scanner-card-body {\n        margin-top: 100px;\n    }\n}\n@media only screen and (max-width: 767px) {\n    .scanner-card-body {\n        margin-top: 10px;\n    }\n    .scanner-card {\n        margin-bottom: 20px;\n    }\n}\n</style>\n"]}]}