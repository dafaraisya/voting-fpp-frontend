{"remainingRequest":"/home/dafa/voting-fpp-frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/dafa/voting-fpp-frontend/src/views/vote/Scan.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/dafa/voting-fpp-frontend/src/views/vote/Scan.vue","mtime":1609126379596},{"path":"/home/dafa/voting-fpp-frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/dafa/voting-fpp-frontend/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/dafa/voting-fpp-frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/dafa/voting-fpp-frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBheGlvcyBmcm9tICdheGlvcycKaW1wb3J0IHsgUXJjb2RlU3RyZWFtIH0gZnJvbSAndnVlLXFyY29kZS1yZWFkZXInCmltcG9ydCBTd2FsIGZyb20gJ3N3ZWV0YWxlcnQyJwoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdTY2FuJywKICBjb21wb25lbnRzOiB7CiAgICBRcmNvZGVTdHJlYW0KICB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBkYXRhUGFydGljaXBhbnQgOiB7CiAgICAgICAgbmFtZTogJycsCiAgICAgICAgbmltOiAnJywKICAgICAgICBlbWFpbDogJycKICAgICAgfSwKICAgICAgaWQgOiAnJywKICAgICAgbG9hZGluZyA6IGZhbHNlCiAgICB9CiAgfSwKICBtZXRob2RzOnsKICAgIGFzeW5jIG9uSW5pdCAocHJvbWlzZSkgewogICAgICB0aGlzLmxvYWRpbmcgPSB0cnVlCgogICAgICB0cnkgewogICAgICAgIGF3YWl0IHByb21pc2UKICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yKQogICAgICB9IGZpbmFsbHkgewogICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlCiAgICAgIH0KICAgIH0sCiAgICBvbkRlY29kZSAoZGVjb2RlZFN0cmluZykgewogICAgICB0aGlzLmlkID0gZGVjb2RlZFN0cmluZzsKICAgICAgYXhpb3MKICAgICAgICAuZ2V0KCJodHRwOi8vbG9jYWxob3N0OjMwMDAvYXBpL3YxL3BhcnRpY2lwYW50LyIrdGhpcy5pZCkKICAgICAgICAudGhlbihyZXMgPT4gewogICAgICAgICAgdGhpcy5kYXRhUGFydGljaXBhbnQgPSByZXMuZGF0YS5kYXRhOwogICAgICAgICAgdGhpcy5jaGVjaygpOwogICAgICAgIH0pCiAgICAgICAgLmNhdGNoKGVyciA9PiB7Y29uc29sZS5sb2coZXJyKX0pOwogICAgfSwKICAgIGNoZWNrKCkgewogICAgICAvLyBjZWsgZGF0YSBwYXJ0aXNpcGFuIGFkYSBlbmdnYWsKICAgICAgaWYodGhpcy5kYXRhUGFydGljaXBhbnQgPT0gbnVsbCkgewogICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsgbmFtZTogIkVycm9yIiwgcGFyYW1zOiB7ZXJyb3IgOiAnZmFpbGVkLW5vdC1mb3VuZCd9fSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gY2VrIGFwYWthaCBzdWRhaCB2b3RlIGFwYSBiZWx1bQogICAgICAgIHZhciBkYXRhUGFydGljaXBhbnRTdHJpbmcgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHRoaXMuZGF0YVBhcnRpY2lwYW50KSk7CiAgICAgICAgaWYoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGRhdGFQYXJ0aWNpcGFudFN0cmluZywgJ3ZvdGluZycpKSB7CiAgICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7IG5hbWU6ICJFcnJvciIsIHBhcmFtczoge2Vycm9yIDogJ2ZhaWxlZC1hbHJlYWR5LXZvdGUnfX0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAvLyBjZWsgYXBha2FoIHNlZGFuZyBzZXNpbnlhIGF0YXUgZW5nZ2FrCiAgICAgICAgICB2YXIgdG9kYXkgPSBuZXcgRGF0ZSgpOwogICAgICAgICAgY29uc3QgZGF0ZSA9IHRvZGF5LmdldEZ1bGxZZWFyKCkrJy0nKyh0b2RheS5nZXRNb250aCgpKzEpKyctJysoJzAnICsgdG9kYXkuZ2V0RGF0ZSgpKS5zbGljZSgtMik7CiAgICAgICAgICBjb25zdCB0aW1lID0gKCcwJyArIHRvZGF5LmdldEhvdXJzKCkpLnNsaWNlKC0yKSArICI6IiArIHRvZGF5LmdldE1pbnV0ZXMoKSArICI6IiArIHRvZGF5LmdldFNlY29uZHMoKTsKICAgICAgICAgIGNvbnN0IGRhdGVUaW1lID0gZGF0ZSArJ1QnKyB0aW1lICsgJy4wMDBaJzsKICAgICAgICAgIGlmKHRoaXMuZGF0YVBhcnRpY2lwYW50LnNlc3Npb24ubWluIDwgZGF0ZVRpbWUgJiYgdGhpcy5kYXRhUGFydGljaXBhbnQuc2Vzc2lvbi5tYXggPiBkYXRlVGltZSkgewogICAgICAgICAgICBTd2FsLmZpcmUoewogICAgICAgICAgICAgICAgaWNvbjogJ3N1Y2Nlc3MnLAogICAgICAgICAgICAgICAgdGl0bGU6ICdBdXRlbnRpa2FzaSBiZXJoYXNpbCcsCiAgICAgICAgICAgICAgICB0ZXh0OiAnU2VsYW1hdCBkYXRhbmcgJyArIHRoaXMuZGF0YVBhcnRpY2lwYW50Lm5hbWUsCiAgICAgICAgICAgICAgICBzaG93Q29uZmlybUJ1dHRvbjogdHJ1ZQogICAgICAgICAgICB9KS50aGVuKCgpPT57CiAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCJzZXRBdXRoZW50aWNhdGlvbiIsIHRydWUpOwogICAgICAgICAgICAgIHRoaXMuJHJvdXRlci5yZXBsYWNlKHsgbmFtZTogIlZvdGluZyIsIHBhcmFtcyA6IHtpZDp0aGlzLmRhdGFQYXJ0aWNpcGFudC5faWR9LCBxdWVyeTogeydzdWNjZXNzJzogdHJ1ZX0gfSk7CiAgICAgICAgICAgIH0pCiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7IG5hbWU6ICJFcnJvciIsIHBhcmFtczoge2Vycm9yIDogJ2ZhaWxlZC1ub3QteW91ci1zZXNzaW9uJ319KTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9LAogIG1vdW50ZWQoKSB7CiAgICBheGlvcwogICAgICAuZ2V0KCJodHRwOi8vbG9jYWxob3N0OjMwMDAvYXBpL3YxL3BhcnRpY2lwYW50L2FsbCIpCiAgICAgIC50aGVuKHJlcyA9PiAodGhpcy5kYXRhUGFydGljaXBhbnRzID0gcmVzLmRhdGEuZGF0YSkpCiAgICAgIC5jYXRjaChlcnJvciA9PiBjb25zb2xlLmxvZyhlcnJvcikpCiAgfQp9Cg=="},{"version":3,"sources":["Scan.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAuBA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Scan.vue","sourceRoot":"src/views/vote","sourcesContent":["<template>\n  <div class=\"scan page pt-5\">\n      <img src=\"\" alt=\"\">\n      <h1 class=\"text-white tittle\">Scan kartu</h1>\n\n      <div class=\"scanner-card mt-5\">\n        <b-row>\n          <b-col lg=\"3\"/>\n          <b-col lg=\"6\">\n            <b-container class=\"bg-white p-3 rounded-sm shadow-sm\">\n              <qrcode-stream @init=\"onInit\" @decode=\"onDecode\">\n                <div class=\"loading-indicator\" v-if=\"loading\">\n                  Loading...\n                </div>\n              </qrcode-stream>\n            </b-container>\n          </b-col>\n        </b-row>\n      </div>\n  </div>\n</template>\n\n<script>\nimport axios from 'axios'\nimport { QrcodeStream } from 'vue-qrcode-reader'\nimport Swal from 'sweetalert2'\n\nexport default {\n  name: 'Scan',\n  components: {\n    QrcodeStream\n  },\n  data() {\n    return {\n      dataParticipant : {\n        name: '',\n        nim: '',\n        email: ''\n      },\n      id : '',\n      loading : false\n    }\n  },\n  methods:{\n    async onInit (promise) {\n      this.loading = true\n\n      try {\n        await promise\n      } catch (error) {\n        console.error(error)\n      } finally {\n        this.loading = false\n      }\n    },\n    onDecode (decodedString) {\n      this.id = decodedString;\n      axios\n        .get(\"http://localhost:3000/api/v1/participant/\"+this.id)\n        .then(res => {\n          this.dataParticipant = res.data.data;\n          this.check();\n        })\n        .catch(err => {console.log(err)});\n    },\n    check() {\n      // cek data partisipan ada enggak\n      if(this.dataParticipant == null) {\n        this.$router.push({ name: \"Error\", params: {error : 'failed-not-found'}});\n      } else {\n        // cek apakah sudah vote apa belum\n        var dataParticipantString = JSON.parse(JSON.stringify(this.dataParticipant));\n        if(Object.prototype.hasOwnProperty.call(dataParticipantString, 'voting')) {\n          this.$router.push({ name: \"Error\", params: {error : 'failed-already-vote'}});\n        } else {\n          // cek apakah sedang sesinya atau enggak\n          var today = new Date();\n          const date = today.getFullYear()+'-'+(today.getMonth()+1)+'-'+('0' + today.getDate()).slice(-2);\n          const time = ('0' + today.getHours()).slice(-2) + \":\" + today.getMinutes() + \":\" + today.getSeconds();\n          const dateTime = date +'T'+ time + '.000Z';\n          if(this.dataParticipant.session.min < dateTime && this.dataParticipant.session.max > dateTime) {\n            Swal.fire({\n                icon: 'success',\n                title: 'Autentikasi berhasil',\n                text: 'Selamat datang ' + this.dataParticipant.name,\n                showConfirmButton: true\n            }).then(()=>{\n              this.$store.commit(\"setAuthentication\", true);\n              this.$router.replace({ name: \"Voting\", params : {id:this.dataParticipant._id}, query: {'success': true} });\n            })\n          } else {\n            this.$router.push({ name: \"Error\", params: {error : 'failed-not-your-session'}});\n          }\n        }\n      }\n    }\n  },\n  mounted() {\n    axios\n      .get(\"http://localhost:3000/api/v1/participant/all\")\n      .then(res => (this.dataParticipants = res.data.data))\n      .catch(error => console.log(error))\n  }\n}\n</script>\n<style scoped>\n.tittle, h1 {\n    font-weight: bold;\n}\n\n.page {\n  margin-top:100px;\n}\n\n.scanner-card {\n    display: block;\n    margin-left: auto;\n    margin-right: auto;\n    max-width: 1000px;\n}\n.alert {\n    display: block;\n    margin-left: auto;\n    margin-right: auto;\n    max-width: 500px;\n}\n.loading-indicator {\n  font-size: 20px ;\n  font-weight: bold;\n  display: block;\n  margin-left: auto;\n  margin-right: auto;\n  margin-top: 100px ;\n  width: 100px;\n}\n\n@media only screen and (min-width: 1200px) and (max-width: 1920px){\n    .scanner-card-body {\n        margin-top: 100px;\n    }\n}\n@media only screen and (max-width: 767px) {\n    .scanner-card-body {\n        margin-top: 10px;\n    }\n    .scanner-card {\n        margin-bottom: 20px;\n    }\n}\n</style>\n"]}]}